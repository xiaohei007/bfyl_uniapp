(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/personal/shop/index"],{"1bb2":function(t,e,n){"use strict";n.r(e);var r=n("f458"),o=n("705e");for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);n("d48b");var a,s=n("f0c5"),c=Object(s["a"])(o["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],a);e["default"]=c.exports},"705e":function(t,e,n){"use strict";n.r(e);var r=n("d688"),o=n.n(r);for(var i in r)"default"!==i&&function(t){n.d(e,t,(function(){return r[t]}))}(i);e["default"]=o.a},a3cc:function(t,e,n){},bbdd:function(t,e,n){"use strict";(function(t){n("cadd");r(n("66fd"));var e=r(n("1bb2"));function r(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},d48b:function(t,e,n){"use strict";var r=n("a3cc"),o=n.n(r);o.a},d688:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("2f62"),o=n("5f4e"),i=n("3fd9"),a=n("1d11");n("bcd8");function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d={data:function(){return{list:[],tabIndex:0,scrollTop:0,isNoData:!1}},computed:c({},(0,r.mapGetters)(["userLocation"])),onLoad:function(){var t=this;(0,o.getUserLocation)().then((function(e){var n=e.data,r=n.latitude,o=n.longitude;t.setUserLocation({latitude:r,longitude:o}),t.getData(r,o)}))},methods:c(c({},(0,r.mapMutations)({setUserLocation:"login/setUserLocation"})),{},{scroll:function(t){this.scrollTop=t.scrollTop},tabItemChange:function(t){if(t!==this.tabIndex){this.scrollTop=0,this.tabIndex=t;var e=this.userLocation,n=e.latitude,r=e.longitude;this.getData(n,r,t)}},openLocation:function(e){if(!e.l_latitude||!e.l_longitude)return this.$refs.xhNotify.show({type:"warning",message:"该商铺没有经纬度，无法前往",duration:2e3});t.openLocation({latitude:e.l_latitude-0,longitude:e.l_longitude-0,name:e.shop_name,address:e.address})},getData:function(t,e,n){var r=this;this.list=[],this.isNoData=!1,(0,i.getnearby)({latitude:t,longitude:e}).then((function(t){var e=t.data||[];if(0===e.length)return r.$refs.xhNotify.show({type:"warning",message:"抱歉您附近暂无可兑换的商铺",duration:2e3}),void(r.isNoData=!0);e.forEach((function(t){0===t.star?t.gradeNumber=.5:t.gradeNumber=t.star,t.dist>1e3?t.distText=(t.dist/1e3).toFixed(2)+"公里":t.distText=Math.round(t.dist)+"米",t.addressText=t.address,t.shopId="(SID-"+t.id+")"})),r.sort(e,n)}))},sort:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;0===n&&t.sort((function(t,e){return e.grade-t.grade})),t.length>20?(this.list=t.slice(0,20),setTimeout((function(){e.list=e.list.concat(t.slice(20,t.length))}),0)):this.list=t}}),onUnload:function(){try{wx.removeStorageSync(a.baseUrl+"/api2/ctools/getnearby")}catch(t){}}};e.default=d}).call(this,n("543d")["default"])},f458:function(t,e,n){"use strict";var r;n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return r}));var o=function(){var t=this,e=t.$createElement;t._self._c},i=[]}},[["bbdd","common/runtime","common/vendor"]]]);